############################
# Application
############################
quarkus.application.name=wtw-backend
quarkus.http.root-path=/api
quarkus.http.host=0.0.0.0

############################
# CORS (dev-friendly)
############################
quarkus.http.cors.enabled=true
quarkus.http.cors.origins=${APP_CORS_ORIGINS:http://localhost:3000,http://localhost:8081,http://localhost:19006}
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors.exposed-headers=location,link
quarkus.http.cors.access-control-max-age=24H
%prod.quarkus.http.cors.origins=${APP_CORS_ORIGINS:https://what-to-wear.cms-building.at}

############################
# MinIO (quarkus-minio)
############################
# Disable Dev Services explicitly
quarkus.minio.devservices.enabled=false

# Connection
quarkus.minio.url=http://localhost:9000
quarkus.minio.region=eu-central-1
quarkus.minio.host=localhost
quarkus.minio.port=9000
quarkus.minio.secure=false
# Credentials (use env vars!)
quarkus.minio.access-key=${MINIO_ACCESS_KEY:admin}
quarkus.minio.secret-key=${MINIO_SECRET_KEY:adminadmin}

############################
# PostgreSQL
############################
quarkus.datasource.db-kind=postgresql
quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/db
quarkus.datasource.username=${DB_USER:app}
quarkus.datasource.password=${DB_PASS:app}

# Pool
quarkus.datasource.jdbc.min-size=2
quarkus.datasource.jdbc.max-size=16

# Hibernate ORM
%test.quarkus.hibernate-orm.schema-management.strategy=drop-and-create
%dev.quarkus.hibernate-orm.schema-management.strategy=update
%prod.quarkus.hibernate-orm.schema-management.strategy=validate

quarkus.datasource.devservices.enabled=false
%dev.quarkus.hibernate-orm.log.sql=true
%test.quarkus.hibernate-orm.log.sql=true
%prod.quarkus.http.access-log.enabled=true

############################
# Security (OIDC)
############################
quarkus.oidc.enabled=true
quarkus.oidc.devservices.enabled=false
quarkus.oidc.application-type=service
quarkus.oidc.auth-server-url=${OIDC_AUTH_SERVER_URL:https://what-to-wear.cms-building.at/auth/realms/wtw}
quarkus.oidc.client-id=${OIDC_CLIENT_ID:wtw-client}

# Allow unauthenticated access to image proxy (object keys are unguessable UUIDs)
quarkus.http.auth.permission.image-proxy.paths=/image/*
quarkus.http.auth.permission.image-proxy.policy=permit
app.minio.public-base-url=${APP_MINIO_PUBLIC_BASE_URL:http://localhost:9000}
app.minio.outfits.bucket=outfits
app.python.base-url=${APP_PYTHON_BASE_URL:http://wtw-python:8000}
app.python.predict-url=${APP_PYTHON_PREDICT_URL:http://wtw-python:8000/wearables/predict}
app.scraper.hm.base-url=${APP_SCRAPER_HM_BASE_URL:http://wtw-hm-scraper:4523}
app.scraper.pinterest.base-url=${APP_SCRAPER_PINTEREST_BASE_URL:http://wtw-pinterest-scraper:4524}
app.scraper.zalando.base-url=${APP_SCRAPER_ZALANDO_BASE_URL:http://wtw-zalando-scraper:4525}

# Local dev backend runs outside Docker, so use host-mapped Python service by default.
%dev.app.python.base-url=${APP_PYTHON_BASE_URL:http://localhost:8084}
%dev.app.python.predict-url=${APP_PYTHON_PREDICT_URL:http://localhost:8084/wearables/predict}
%dev.app.scraper.hm.base-url=${APP_SCRAPER_HM_BASE_URL:http://localhost:4523}
%dev.app.scraper.pinterest.base-url=${APP_SCRAPER_PINTEREST_BASE_URL:http://localhost:4524}
%dev.app.scraper.zalando.base-url=${APP_SCRAPER_ZALANDO_BASE_URL:http://localhost:4525}
